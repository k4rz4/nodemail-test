
/*
────░░░───────────────────────────░░░───
─░░░─────────░▒▒▒▓▓▓▓▓▓▓▓▓▓▒▒▓▓─────░───
░░──────▒█████████████▓▓▓▓▓▒▓▓██▓────░──
░────▒███▓▒▒░──░▒▒░──░░░░░░░────██────░─
░───██░───░░▒░░░░───░─░░▒▒▓▓▒░───██───░░
───▓█───▒░───▒░────▒───────▒▒▒░──░█────░
───█▒─────────░──────▓████▒───────██────
──██────██████─────██▓▓█████▓─░────██───
─██▒░───▓███████──░████▓█▓▒█▒─▓▓▓█▒─██▓─
▓█─░▓██▓──────█─────▒───▒█▓░▒███▓░██──█▒
██──▒░▒███▒──██───────────▒▒▒──▒█──██─░█
░█─░──█────██▓─────▓██▒─────▒██▒██▒▓█──█
─██░─██░───██▓───██▓░█──▒████───█░─█░─██
──█──████▓───▒██───░████▓░─██▒███────██─
──█▓─█▓█░███████████▒░█──▒███▒██────██──
──█▓─███░█▓──█▒─░█───▒███████▓█────██───
──██─███████████████████───░██────▓█────
──██─██████████████▒───█──██▓────░█░───░
──█▓─░██▓█─█─▒█───█────████─────██▒───░░
──█▒──▒██████▒█▒▒███████▒──░▒▓███─────░─
──█░──────▒▒██████▒▒░░──░▒░▓███▒──────░─
──█──▒─▒▒──────────░▒▒░──▓██░────░░────░
──█──░▒▒▒▒▒░░─░─░─░───░███████▒───░────░
──██─────────────░▒▒▓███████████──░░───░
───██▓░──────▒▓████▓░──█████████▒──░────
──░──█████████████───▒▓██████████──░░───
──░──██████████████▒▓████████████░──░───
──░──▓███████████▓───░███████████▓──░───
──░───███████████─────████████████──░───
───░───██████████░▒███████████████──░───
───░░───▓███████████████████▒─▓██───░───
───░▒───█████████████████████──────░░───
──░░───██████████████████████───░░░─────
─░░───████████████████████████──░▒─────░
─░───█████████████████████████───▒─────░
░───██████████████████████████▓───░░────
░──▓███████████████████████████░───░░───
──░█████████████████████████████▓───░░──
░──▓██████████████████████████████────░─
░────▓█████████████████████████████░───░
▒────███████████████████████████████▒──░
───▒█████████████████████████████████───
──▒███████████████████████████████████──
─░████████████████████████████████████──
─█████████████░─────────░█████████████░─
─███████████░─────────────████████████──
─▓██████████───░░░░░░▒▒───▒███████████──
──██████████──░░────░░───░███████████▒──
──██████████──░─────░───█████████████───
───█████████──░░───░───█████████████───░
░──█████████───░───░───███████████▒───░░
░──▒████████░──░───░──██████████▒────░░─
░───████████▓──░───░──███▓████▒────░░───
░░──████████───░───░───██░─▓─────░░░────
─░──▒███▒─█▓──░░───░░───▒███───░░───────
─░░───░█░─▓█──░░────░░───███──░░──────░░
──░────█▓███──░──────░░───░───░────░░░──
──░░──█▒─██───░────────░─────░░───░░────
──░──░████───░░─────────░░░░░─────░─────
──░░──▒░────░░────▒░─────────────░──────

*/




var express 		= require('express');
var helmet 			= require('helmet');
var nodemailer 		= require("nodemailer");
var app 			= express();
var csurf 			= require('csurf');

/*------- Konfiguracija SMTP Servera ----------------*/
var smtpTransport = nodemailer.createTransport("SMTP",{
    service: "Gmail",
    auth: {
        user: "karzicmarko@gmail.com",
        pass: ""
    }
});

/*---------------------Rutovanje---------------------*/
app.get('/',function(req,res){
	res.sendFile('/home/s1ck/Documents/Posao/nodemailer/index.html');
});

app.post('/send',function(req,res){
	var mailOptions={
		to : 'karzicmarko@gmail.com',
	   subject : 'New message',
	   text : req.query.text,
	   csfr : req.query.csfr
	}
	console.log(mailOptions);
	smtpTransport.sendMail(mailOptions, function(error, response){
		if(error) {
			console.log(error);
			res.end("error");
		} else {
			console.log("Message sent: " + response.message);
			res.end("sent");
		}
	});
});

/*------------------------------------------------*/

app.listen(3000,function(){
	console.log("Express Started on Port 3000");
});
